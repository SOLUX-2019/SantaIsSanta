import { __decorate } from "tslib";
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { UUID } from 'angular2-uuid';
import { MatSnackBar } from '@angular/material/snack-bar';
import { StreamActivity, StreamClientService } from '@brightpath/activity-stream';
let ProviderPrivateMessageComponent = class ProviderPrivateMessageComponent {
    constructor(streamClientService, snackbar) {
        this.streamClientService = streamClientService;
        this.snackbar = snackbar;
        this.close = new EventEmitter();
    }
    onPrivateMessage(privateMessage) {
        privateMessage.actor = 'customers:' + this.customerId;
        privateMessage.threadId = UUID.UUID();
        privateMessage.to = [`notification:${this.providerId}`];
        privateMessage.target = `inbox:${this.providerId}`;
        this.streamClientService.getToken('inbox', this.providerId).then((response) => {
            const token = response.token;
            this.streamClientService.addActivity(privateMessage, 'inbox', this.providerId, token).then((privateMessageResponse) => {
                this.snackbar.open('Sent Private Message', 'OK', {
                    verticalPosition: 'top',
                    duration: 2000
                });
            });
            this.close.emit(true);
        });
    }
    ngOnInit() {
    }
};
ProviderPrivateMessageComponent.ctorParameters = () => [
    { type: StreamClientService },
    { type: MatSnackBar }
];
__decorate([
    Input()
], ProviderPrivateMessageComponent.prototype, "customerId", void 0);
__decorate([
    Input()
], ProviderPrivateMessageComponent.prototype, "providerId", void 0);
__decorate([
    Output()
], ProviderPrivateMessageComponent.prototype, "close", void 0);
ProviderPrivateMessageComponent = __decorate([
    Component({
        selector: 'provider-private-message',
        template: "<div class=\"p-8\">\n  <div fxLayout=\"row\" fxLayoutAlign=\"center center\" class=\"message-box error\">\n    If you are in immediate need of counseling or support, please call 911.  Messages sent to your counselor can take up to 24 hours to be read and replied to\n  </div>\n  <div fxLayout=\"column\">\n    <div fxLayout=\"row\" class=\"mt-16\">\n      <lib-activity-editor (onActivity)=\"onPrivateMessage($event)\" fxFlex></lib-activity-editor>\n    </div>\n  </div>\n</div>\n",
        styles: [""]
    })
], ProviderPrivateMessageComponent);
export { ProviderPrivateMessageComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvdmlkZXItcHJpdmF0ZS1tZXNzYWdlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3Byb3ZpZGVycy8iLCJzb3VyY2VzIjpbImxpYi9wcm92aWRlcnMvcHJvdmlkZXItcHJpdmF0ZS1tZXNzYWdlL3Byb3ZpZGVyLXByaXZhdGUtbWVzc2FnZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDN0UsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNuQyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDMUQsT0FBTyxFQUFDLGNBQWMsRUFBRSxtQkFBbUIsRUFBQyxNQUFNLDZCQUE2QixDQUFDO0FBT2hGLElBQWEsK0JBQStCLEdBQTVDLE1BQWEsK0JBQStCO0lBTTFDLFlBQW9CLG1CQUF3QyxFQUFVLFFBQXFCO1FBQXZFLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFBVSxhQUFRLEdBQVIsUUFBUSxDQUFhO1FBRmpGLFVBQUssR0FBRyxJQUFJLFlBQVksRUFBVyxDQUFDO0lBRzlDLENBQUM7SUFFRCxnQkFBZ0IsQ0FBQyxjQUE4QjtRQUM3QyxjQUFjLENBQUMsS0FBSyxHQUFHLFlBQVksR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO1FBQ3RELGNBQWMsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3RDLGNBQWMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxnQkFBZ0IsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUM7UUFDeEQsY0FBYyxDQUFDLE1BQU0sR0FBRyxTQUFTLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNuRCxJQUFJLENBQUMsbUJBQW1CLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBYSxFQUFFLEVBQUU7WUFDakYsTUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQztZQUM3QixJQUFJLENBQUMsbUJBQW1CLENBQUMsV0FBVyxDQUFDLGNBQWMsRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxzQkFBc0IsRUFBRSxFQUFFO2dCQUNwSCxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxJQUFJLEVBQUU7b0JBQy9DLGdCQUFnQixFQUFFLEtBQUs7b0JBQ3ZCLFFBQVEsRUFBVSxJQUFJO2lCQUN2QixDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELFFBQVE7SUFDUixDQUFDO0NBRUYsQ0FBQTs7WUF2QjBDLG1CQUFtQjtZQUFvQixXQUFXOztBQUpsRjtJQUFSLEtBQUssRUFBRTttRUFBWTtBQUNYO0lBQVIsS0FBSyxFQUFFO21FQUFZO0FBQ1Y7SUFBVCxNQUFNLEVBQUU7OERBQXFDO0FBSm5DLCtCQUErQjtJQUwzQyxTQUFTLENBQUM7UUFDVCxRQUFRLEVBQUUsMEJBQTBCO1FBQ3BDLDRlQUF3RDs7S0FFekQsQ0FBQztHQUNXLCtCQUErQixDQTZCM0M7U0E3QlksK0JBQStCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7VVVJRH0gZnJvbSAnYW5ndWxhcjItdXVpZCc7XG5pbXBvcnQgeyBNYXRTbmFja0JhciB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL3NuYWNrLWJhcic7XG5pbXBvcnQge1N0cmVhbUFjdGl2aXR5LCBTdHJlYW1DbGllbnRTZXJ2aWNlfSBmcm9tICdAYnJpZ2h0cGF0aC9hY3Rpdml0eS1zdHJlYW0nO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdwcm92aWRlci1wcml2YXRlLW1lc3NhZ2UnLFxuICB0ZW1wbGF0ZVVybDogJy4vcHJvdmlkZXItcHJpdmF0ZS1tZXNzYWdlLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vcHJvdmlkZXItcHJpdmF0ZS1tZXNzYWdlLmNvbXBvbmVudC5zY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgUHJvdmlkZXJQcml2YXRlTWVzc2FnZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG5cbiAgQElucHV0KCkgY3VzdG9tZXJJZDtcbiAgQElucHV0KCkgcHJvdmlkZXJJZDtcbiAgQE91dHB1dCgpIGNsb3NlID0gbmV3IEV2ZW50RW1pdHRlcjxib29sZWFuPigpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc3RyZWFtQ2xpZW50U2VydmljZTogU3RyZWFtQ2xpZW50U2VydmljZSwgcHJpdmF0ZSBzbmFja2JhcjogTWF0U25hY2tCYXIpIHtcbiAgfVxuXG4gIG9uUHJpdmF0ZU1lc3NhZ2UocHJpdmF0ZU1lc3NhZ2U6IFN0cmVhbUFjdGl2aXR5KSB7XG4gICAgcHJpdmF0ZU1lc3NhZ2UuYWN0b3IgPSAnY3VzdG9tZXJzOicgKyB0aGlzLmN1c3RvbWVySWQ7XG4gICAgcHJpdmF0ZU1lc3NhZ2UudGhyZWFkSWQgPSBVVUlELlVVSUQoKTtcbiAgICBwcml2YXRlTWVzc2FnZS50byA9IFtgbm90aWZpY2F0aW9uOiR7dGhpcy5wcm92aWRlcklkfWBdO1xuICAgIHByaXZhdGVNZXNzYWdlLnRhcmdldCA9IGBpbmJveDoke3RoaXMucHJvdmlkZXJJZH1gO1xuICAgIHRoaXMuc3RyZWFtQ2xpZW50U2VydmljZS5nZXRUb2tlbignaW5ib3gnLCB0aGlzLnByb3ZpZGVySWQpLnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gcmVzcG9uc2UudG9rZW47XG4gICAgICB0aGlzLnN0cmVhbUNsaWVudFNlcnZpY2UuYWRkQWN0aXZpdHkocHJpdmF0ZU1lc3NhZ2UsICdpbmJveCcsIHRoaXMucHJvdmlkZXJJZCwgdG9rZW4pLnRoZW4oKHByaXZhdGVNZXNzYWdlUmVzcG9uc2UpID0+IHtcbiAgICAgICAgdGhpcy5zbmFja2Jhci5vcGVuKCdTZW50IFByaXZhdGUgTWVzc2FnZScsICdPSycsIHtcbiAgICAgICAgICB2ZXJ0aWNhbFBvc2l0aW9uOiAndG9wJyxcbiAgICAgICAgICBkdXJhdGlvbiAgICAgICAgOiAyMDAwXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmNsb3NlLmVtaXQodHJ1ZSk7XG4gICAgfSk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgfVxuXG59XG4iXX0=