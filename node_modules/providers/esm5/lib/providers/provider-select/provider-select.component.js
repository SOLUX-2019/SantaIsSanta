import { __decorate } from "tslib";
import { Component, Input } from '@angular/core';
import { Router } from '@angular/router';
import { StreamActivity, StreamClientService } from '@brightpath/activity-stream';
import { CustomerService, ProvidersService } from '@brightpath/scheduling';
var ProviderSelectComponent = /** @class */ (function () {
    function ProviderSelectComponent(providerService, customerService, streamClient, router) {
        this.providerService = providerService;
        this.customerService = customerService;
        this.streamClient = streamClient;
        this.router = router;
        this.loading = false;
        this.providers = [];
    }
    ProviderSelectComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.customer === null || this.customer === undefined) {
            // load the customer
            this.customerService.loadCustomer(this.customerId).subscribe(function (customerList) {
                if (customerList !== null && customerList.length > 0) {
                    _this.customer = customerList[0];
                }
            });
        }
        this.loadProviders();
    };
    ProviderSelectComponent.prototype.loadProviders = function () {
        var _this = this;
        this.providerService.getAllProviders().then(function (providers) {
            console.log(providers);
            _this.providers = providers;
        });
    };
    ProviderSelectComponent.prototype.onProviderSelected = function (newProvider) {
        var _this = this;
        console.log('the user wants this guy: ', newProvider);
        if (this.customer.preferredProvider !== null && this.customer.preferredProvider !== undefined) {
            // this person is switching providers.  Create an activity and CC it to the old provider's notification stream
            this.streamClient.getToken('timeline', this.customer.id).then(function (response) {
                var token = response.token;
                var activity = new StreamActivity();
                activity.verb = 'cancelprovider';
                activity.actor = "customers:" + _this.customer.id;
                activity.target = "providers:" + _this.customer.preferredProvider;
                activity.to = ["notification:" + _this.customer.preferredProvider];
                activity.object = 'none';
                console.log('about to create the following', activity);
                _this.streamClient.addActivity(activity, 'timeline', _this.customer.id, token);
            });
        }
        this.customer.preferredProvider = newProvider.id;
        // TODO: Need to signal that the preferred provider has changed
        // this.auth.saveAuthIdentityToLocalStorage();
        this.customerService.saveCustomer(this.customer)
            .subscribe(function (response) {
            _this.streamClient.getToken('timeline', _this.customer.id).then(function (tokenresponse) {
                console.log('got the ticket honkey dorey');
                var token = tokenresponse.token;
                var activity = new StreamActivity();
                activity.verb = 'preferredprovider';
                activity.actor = "customers:" + _this.customer.id;
                activity.target = "providers:" + _this.customer.preferredProvider;
                activity.to = ["notification:" + _this.customer.preferredProvider];
                activity.object = 'none';
                console.log('about to create the following', activity);
                _this.streamClient.addActivity(activity, 'timeline', _this.customer.id, token);
                // now follow the new provider
                _this.streamClient.follow(_this.customer.id, 'timeline', _this.customer.preferredProvider, 'providers');
            });
            // TODO: This shouldn't navigate, but should instead emit an event
            _this.router.navigateByUrl('home');
        });
    };
    ProviderSelectComponent.ctorParameters = function () { return [
        { type: ProvidersService },
        { type: CustomerService },
        { type: StreamClientService },
        { type: Router }
    ]; };
    __decorate([
        Input()
    ], ProviderSelectComponent.prototype, "customerId", void 0);
    __decorate([
        Input()
    ], ProviderSelectComponent.prototype, "customer", void 0);
    ProviderSelectComponent = __decorate([
        Component({
            selector: 'provider-select',
            template: "<div fxLayout=\"column\" class=\"page-layout blank p-24\" fxLayoutGap=\"16px\" fusePerfectScrollbar>\n  <div fxLayout=\"row\" fxLayoutWrap fxLayoutGap=\"16px\">\n    <provider-widget (onSelectedProvider)=\"onProviderSelected($event)\" fxFlex=\"25\" class=\"mb-16\" *ngFor=\"let provider of providers\" [provider]=\"provider\"></provider-widget>\n  </div>\n</div>\n",
            styles: [""]
        })
    ], ProviderSelectComponent);
    return ProviderSelectComponent;
}());
export { ProviderSelectComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvdmlkZXItc2VsZWN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3Byb3ZpZGVycy8iLCJzb3VyY2VzIjpbImxpYi9wcm92aWRlcnMvcHJvdmlkZXItc2VsZWN0L3Byb3ZpZGVyLXNlbGVjdC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsS0FBSyxFQUFTLE1BQU0sZUFBZSxDQUFDO0FBQ3ZELE9BQU8sRUFBQyxNQUFNLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUN2QyxPQUFPLEVBQUMsY0FBYyxFQUFFLG1CQUFtQixFQUFDLE1BQU0sNkJBQTZCLENBQUM7QUFDaEYsT0FBTyxFQUFDLGVBQWUsRUFBRSxnQkFBZ0IsRUFBQyxNQUFNLHdCQUF3QixDQUFDO0FBUXpFO0lBT0UsaUNBQ1UsZUFBaUMsRUFDakMsZUFBZ0MsRUFDaEMsWUFBaUMsRUFDakMsTUFBYztRQUhkLG9CQUFlLEdBQWYsZUFBZSxDQUFrQjtRQUNqQyxvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFDaEMsaUJBQVksR0FBWixZQUFZLENBQXFCO1FBQ2pDLFdBQU0sR0FBTixNQUFNLENBQVE7UUFQeEIsWUFBTyxHQUFHLEtBQUssQ0FBQztRQUNoQixjQUFTLEdBQUcsRUFBRSxDQUFDO0lBTWEsQ0FBQztJQUU3QiwwQ0FBUSxHQUFSO1FBQUEsaUJBVUM7UUFUQyxJQUFJLElBQUksQ0FBQyxRQUFRLEtBQUssSUFBSSxJQUFJLElBQUksQ0FBQyxRQUFRLEtBQUssU0FBUyxFQUFFO1lBQ3pELG9CQUFvQjtZQUNwQixJQUFJLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLFVBQUMsWUFBd0I7Z0JBQ3BGLElBQUksWUFBWSxLQUFLLElBQUksSUFBSSxZQUFZLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtvQkFDcEQsS0FBSSxDQUFDLFFBQVEsR0FBRyxZQUFZLENB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TUFBTSxDQUFDO2dCQUN6QixPQUFPLENBQUMsR0FBRyxDQUFDLCtCQUErQixFQUFFLFFBQVEsQ0FBQyxDQUFDO2dCQUN2RCxLQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsVUFBVSxFQUFFLEtBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO2dCQUU3RSw4QkFBOEI7Z0JBQzlCLEtBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEtBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFLFVBQVUsRUFBRSxLQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixFQUFFLFdBQVcsQ0FBQyxDQUFDO1lBQ3ZHLENBQUMsQ0FBQyxDQUFDO1lBRUgsa0VBQWtFO1lBQ2xFLEtBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQzs7Z0JBbEUwQixnQkFBZ0I7Z0JBQ2hCLGVBQWU7Z0JBQ2xCLG1CQUFtQjtnQkFDekIsTUFBTTs7SUFUZjtRQUFSLEtBQUssRUFBRTsrREFBWTtJQUNYO1FBQVIsS0FBSyxFQUFFOzZEQUFVO0lBSFAsdUJBQXVCO1FBTG5DLFNBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxpQkFBaUI7WUFDM0Isd1hBQStDOztTQUVoRCxDQUFDO09BQ1csdUJBQXVCLENBNEVuQztJQUFELDhCQUFDO0NBQUEsQUE1RUQsSUE0RUM7U0E1RVksdUJBQXVCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIElucHV0LCBPbkluaXR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQge1N0cmVhbUFjdGl2aXR5LCBTdHJlYW1DbGllbnRTZXJ2aWNlfSBmcm9tICdAYnJpZ2h0cGF0aC9hY3Rpdml0eS1zdHJlYW0nO1xuaW1wb3J0IHtDdXN0b21lclNlcnZpY2UsIFByb3ZpZGVyc1NlcnZpY2V9IGZyb20gJ0BicmlnaHRwYXRoL3NjaGVkdWxpbmcnO1xuaW1wb3J0IHtDdXN0b21lcn0gZnJvbSAnQGJyaWdodHBhdGgvY29tbW9uJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAncHJvdmlkZXItc2VsZWN0JyxcbiAgdGVtcGxhdGVVcmw6ICcuL3Byb3ZpZGVyLXNlbGVjdC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3Byb3ZpZGVyLXNlbGVjdC5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFByb3ZpZGVyU2VsZWN0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICBASW5wdXQoKSBjdXN0b21lcklkO1xuICBASW5wdXQoKSBjdXN0b21lcjtcbiAgbG9hZGluZyA9IGZhbHNlO1xuICBwcm92aWRlcnMgPSBbXTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHByb3ZpZGVyU2VydmljZTogUHJvdmlkZXJzU2VydmljZSxcbiAgICBwcml2YXRlIGN1c3RvbWVyU2VydmljZTogQ3VzdG9tZXJTZXJ2aWNlLFxuICAgIHByaXZhdGUgc3RyZWFtQ2xpZW50OiBTdHJlYW1DbGllbnRTZXJ2aWNlLFxuICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIpIHsgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGlmICh0aGlzLmN1c3RvbWVyID09PSBudWxsIHx8IHRoaXMuY3VzdG9tZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gbG9hZCB0aGUgY3VzdG9tZXJcbiAgICAgIHRoaXMuY3VzdG9tZXJTZXJ2aWNlLmxvYWRDdXN0b21lcih0aGlzLmN1c3RvbWVySWQpLnN1YnNjcmliZSgoY3VzdG9tZXJMaXN0OiBDdXN0b21lcltdKSA9PiB7XG4gICAgICAgIGlmIChjdXN0b21lckxpc3QgIT09IG51bGwgJiYgY3VzdG9tZXJMaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLmN1c3RvbWVyID0gY3VzdG9tZXJMaXN0WzBdO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5sb2FkUHJvdmlkZXJzKCk7XG4gIH1cblxuICBsb2FkUHJvdmlkZXJzKCkge1xuICAgIHRoaXMucHJvdmlkZXJTZXJ2aWNlLmdldEFsbFByb3ZpZGVycygpLnRoZW4oKHByb3ZpZGVyczogYW55W10pID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHByb3ZpZGVycyk7XG4gICAgICB0aGlzLnByb3ZpZGVycyA9IHByb3ZpZGVycztcbiAgICB9KTtcblxuICB9XG5cbiAgb25Qcm92aWRlclNlbGVjdGVkKG5ld1Byb3ZpZGVyKSB7XG4gICAgY29uc29sZS5sb2coJ3RoZSB1c2VyIHdhbnRzIHRoaXMgZ3V5OiAnLCBuZXdQcm92aWRlcik7XG4gICAgaWYgKHRoaXMuY3VzdG9tZXIucHJlZmVycmVkUHJvdmlkZXIgIT09IG51bGwgJiYgdGhpcy5jdXN0b21lci5wcmVmZXJyZWRQcm92aWRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyB0aGlzIHBlcnNvbiBpcyBzd2l0Y2hpbmcgcHJvdmlkZXJzLiAgQ3JlYXRlIGFuIGFjdGl2aXR5IGFuZCBDQyBpdCB0byB0aGUgb2xkIHByb3ZpZGVyJ3Mgbm90aWZpY2F0aW9uIHN0cmVhbVxuICAgICAgdGhpcy5zdHJlYW1DbGllbnQuZ2V0VG9rZW4oJ3RpbWVsaW5lJywgdGhpcy5jdXN0b21lci5pZCkudGhlbigocmVzcG9uc2U6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCB0b2tlbiA9IHJlc3BvbnNlLnRva2VuO1xuICAgICAgICBjb25zdCBhY3Rpdml0eTogU3RyZWFtQWN0aXZpdHkgPSBuZXcgU3RyZWFtQWN0aXZpdHkoKTtcbiAgICAgICAgYWN0aXZpdHkudmVyYiA9ICdjYW5jZWxwcm92aWRlcic7XG4gICAgICAgIGFjdGl2aXR5LmFjdG9yID0gYGN1c3RvbWVyczoke3RoaXMuY3VzdG9tZXIuaWR9YDtcbiAgICAgICAgYWN0aXZpdHkudGFyZ2V0ID0gYHByb3ZpZGVyczoke3RoaXMuY3VzdG9tZXIucHJlZmVycmVkUHJvdmlkZXJ9YDtcbiAgICAgICAgYWN0aXZpdHkudG8gPSBbYG5vdGlmaWNhdGlvbjoke3RoaXMuY3VzdG9tZXIucHJlZmVycmVkUHJvdmlkZXJ9YF07XG4gICAgICAgIGFjdGl2aXR5Lm9iamVjdCA9ICdub25lJztcbiAgICAgICAgY29uc29sZS5sb2coJ2Fib3V0IHRvIGNyZWF0ZSB0aGUgZm9sbG93aW5nJywgYWN0aXZpdHkpO1xuICAgICAgICB0aGlzLnN0cmVhbUNsaWVudC5hZGRBY3Rpdml0eShhY3Rpdml0eSwgJ3RpbWVsaW5lJywgdGhpcy5jdXN0b21lci5pZCwgdG9rZW4pO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuY3VzdG9tZXIucHJlZmVycmVkUHJvdmlkZXIgPSBuZXdQcm92aWRlci5pZDtcbiAgICAvLyBUT0RPOiBOZWVkIHRvIHNpZ25hbCB0aGF0IHRoZSBwcmVmZXJyZWQgcHJvdmlkZXIgaGFzIGNoYW5nZWRcbiAgICAvLyB0aGlzLmF1dGguc2F2ZUF1dGhJZGVudGl0eVRvTG9jYWxTdG9yYWdlKCk7XG4gICAgdGhpcy5jdXN0b21lclNlcnZpY2Uuc2F2ZUN1c3RvbWVyKHRoaXMuY3VzdG9tZXIpXG4gICAgICAuc3Vic2NyaWJlKChyZXNwb25zZSkgPT4ge1xuXG4gICAgICAgIHRoaXMuc3RyZWFtQ2xpZW50LmdldFRva2VuKCd0aW1lbGluZScsIHRoaXMuY3VzdG9tZXIuaWQpLnRoZW4oKHRva2VucmVzcG9uc2U6IGFueSkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdnb3QgdGhlIHRpY2tldCBob25rZXkgZG9yZXknKTtcbiAgICAgICAgICBjb25zdCB0b2tlbiA9IHRva2VucmVzcG9uc2UudG9rZW47XG4gICAgICAgICAgY29uc3QgYWN0aXZpdHk6IFN0cmVhbUFjdGl2aXR5ID0gbmV3IFN0cmVhbUFjdGl2aXR5KCk7XG4gICAgICAgICAgYWN0aXZpdHkudmVyYiA9ICdwcmVmZXJyZWRwcm92aWRlcic7XG4gICAgICAgICAgYWN0aXZpdHkuYWN0b3IgPSBgY3VzdG9tZXJzOiR7dGhpcy5jdXN0b21lci5pZH1gO1xuICAgICAgICAgIGFjdGl2aXR5LnRhcmdldCA9IGBwcm92aWRlcnM6JHt0aGlzLmN1c3RvbWVyLnByZWZlcnJlZFByb3ZpZGVyfWA7XG4gICAgICAgICAgYWN0aXZpdHkudG8gPSBbYG5vdGlmaWNhdGlvbjoke3RoaXMuY3VzdG9tZXIucHJlZmVycmVkUHJvdmlkZXJ9YF07XG4gICAgICAgICAgYWN0aXZpdHkub2JqZWN0ID0gJ25vbmUnO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdhYm91dCB0byBjcmVhdGUgdGhlIGZvbGxvd2luZycsIGFjdGl2aXR5KTtcbiAgICAgICAgICB0aGlzLnN0cmVhbUNsaWVudC5hZGRBY3Rpdml0eShhY3Rpdml0eSwgJ3RpbWVsaW5lJywgdGhpcy5jdXN0b21lci5pZCwgdG9rZW4pO1xuXG4gICAgICAgICAgLy8gbm93IGZvbGxvdyB0aGUgbmV3IHByb3ZpZGVyXG4gICAgICAgICAgdGhpcy5zdHJlYW1DbGllbnQuZm9sbG93KHRoaXMuY3VzdG9tZXIuaWQsICd0aW1lbGluZScsIHRoaXMuY3VzdG9tZXIucHJlZmVycmVkUHJvdmlkZXIsICdwcm92aWRlcnMnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVE9ETzogVGhpcyBzaG91bGRuJ3QgbmF2aWdhdGUsIGJ1dCBzaG91bGQgaW5zdGVhZCBlbWl0IGFuIGV2ZW50XG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlQnlVcmwoJ2hvbWUnKTtcbiAgICAgIH0pO1xuICB9XG5cbn1cbiJdfQ==